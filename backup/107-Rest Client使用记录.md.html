
  <article class="markdown-body">
    <h2 id="_1">自定义变量</h2>
<h3 id="_2">环境变量</h3>
<p>存储不同环境的变量, 在Visual Studio代码设置文件中直接定义.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;rest-client.environmentVariables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;$shared&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;prodToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;foo&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;nonProdToken&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;local&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;v2&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{$shared nonProdToken}}&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;secretKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;devSecret&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;production&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;example.com&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{$shared prodToken}}&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;secretKey&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prodSecret&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="_3">文件变量</h3>
<p>表示整个http文件的值, 在http文件中定义, 只有文件范围</p>
<p><code>@hostname = api.example.com</code></p>
<h3 id="_4">请求变量</h3>
<p>在http文件中定义, 定义请求变量的响应值, 作为下个请求的参数, 比如先获取token, 再请求</p>
<div class="highlight"><pre><span></span><code>@baseUrl = https://example.com/api

# @name login
POST {{baseUrl}}/api/login HTTP/1.1
Content-Type: application/x-www-form-urlencoded

name=foo&amp;password=bar

###

@authToken = {{login.response.headers.X-AuthToken}}

# @name createComment
POST {{baseUrl}}/comments HTTP/1.1
Authorization: {{authToken}}
Content-Type: application/json

{
    &quot;content&quot;: &quot;fake content&quot;
}

###

@commentId = {{createComment.response.body.$.id}}

# @name getCreatedComment
GET {{baseUrl}}/comments/{{commentId}} HTTP/1.1
Authorization: {{authToken}}

###

# @name getReplies
GET {{baseUrl}}/comments/{{commentId}}/replies HTTP/1.1
Accept: application/xml

###

# @name getFirstReply
GET {{baseUrl}}/comments/{{commentId}}/replies/{{getReplies.response.body.//reply[1]/@id}}
</code></pre></div>

<h3 id="_5">提示变量</h3>
<p>发送请求时 要求用户输入使用的变量</p>
<div class="highlight"><pre><span></span><code># @prompt text 请求时弹框提示输入文本
GET https://127.0.0.1/test

{
    &quot;text&quot;: &quot;{{text}}&quot;,
}
</code></pre></div>

<h2 id="_6">内置变量</h2>
<div class="highlight"><pre><span></span><code><span class="p">{{</span><span class="n">$guid</span><span class="p">}}</span>
<span class="p">{{</span><span class="n">$randomInt</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">max</span><span class="p">}}</span>
<span class="p">{{</span><span class="n">$timestamp</span><span class="w"> </span><span class="p">[</span><span class="n">offset</span><span class="w"> </span><span class="n">option</span><span class="p">]}}</span>

<span class="p">{{</span><span class="n">$datetime</span><span class="p">}}</span><span class="w"> </span><span class="n">时间戳</span>
<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="mi">-3</span><span class="w"> </span><span class="n">h</span><span class="p">}}</span><span class="w"> </span><span class="mi">3</span><span class="n">小时前</span>
<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">d</span><span class="p">}}</span><span class="w"> </span><span class="mi">2</span><span class="n">天后</span>

<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="n">rfc1123</span><span class="o">|</span><span class="n">iso8601</span><span class="w"> </span><span class="p">[</span><span class="n">offset</span><span class="w"> </span><span class="n">option</span><span class="p">]}}</span>

<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="n">rfc1123</span><span class="p">}}</span><span class="w">       </span><span class="n">Wed</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="mo">06</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">49</span><span class="w"> </span><span class="n">GMT</span>
<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="n">iso8601</span><span class="p">}}</span><span class="w">       </span><span class="mi">2025</span><span class="mo">-04</span><span class="mi">-16</span><span class="n">T06</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mf">53.379</span><span class="n">Z</span>
<span class="p">{{</span><span class="n">$datetime</span><span class="w"> </span><span class="err">&#39;</span><span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span><span class="err">&#39;</span><span class="p">}}</span><span class="w">  </span><span class="mi">2025</span><span class="mo">-04</span><span class="mi">-16</span>

<span class="p">{{</span><span class="n">$localDatetime</span><span class="w"> </span><span class="n">rfc1123</span><span class="o">|</span><span class="n">iso8601</span><span class="w"> </span><span class="p">[</span><span class="n">offset</span><span class="w"> </span><span class="n">option</span><span class="p">]}}</span>
<span class="n">使用本地时区</span>
<span class="p">{{</span><span class="n">$localDatetime</span><span class="w"> </span><span class="n">rfc1123</span><span class="p">}}</span><span class="w">       </span><span class="n">Wed</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="mo">06</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mi">49</span><span class="w"> </span><span class="n">GMT</span>
<span class="p">{{</span><span class="n">$localDatetime</span><span class="w"> </span><span class="n">iso8601</span><span class="p">}}</span><span class="w">       </span><span class="mi">2025</span><span class="mo">-04</span><span class="mi">-16</span><span class="n">T14</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mi">57</span><span class="o">+</span><span class="mi">08</span><span class="o">:</span><span class="mo">00</span>
<span class="p">{{</span><span class="n">$localDatetime</span><span class="w"> </span><span class="err">&#39;</span><span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span><span class="err">&#39;</span><span class="p">}}</span><span class="w">  </span><span class="mi">2025</span><span class="mo">-04</span><span class="mi">-16</span>

<span class="p">{{</span><span class="n">$processEnv</span><span class="w"> </span><span class="p">[</span><span class="o">%</span><span class="p">]</span><span class="n">envVarName</span><span class="p">}}</span>
<span class="nl">envVarName</span><span class="p">:</span><span class="w"> </span><span class="n">指定本地机器环境变量</span>
<span class="o">%:</span><span class="w"> </span><span class="n">可选</span><span class="p">,</span><span class="w"> </span><span class="n">制定时</span><span class="p">,</span><span class="w"> </span><span class="n">将envVarName视为扩展设置环境变量</span><span class="p">,</span><span class="w"> </span><span class="n">并将其值用于查找</span><span class="p">.</span>

<span class="p">{{</span><span class="n">$processEnv</span><span class="w"> </span><span class="n">PATH</span><span class="p">}}</span><span class="w"> </span><span class="n">PATH环境变量</span>


<span class="p">{{</span><span class="n">$dotenv</span><span class="w"> </span><span class="p">[</span><span class="o">%</span><span class="p">]</span><span class="n">variableName</span><span class="p">}}</span>
<span class="n">返回</span><span class="p">.</span><span class="n">env文件中设置的环境变量</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">env文件与</span><span class="p">.</span><span class="n">http文件在统一目录中</span>

<span class="p">.</span><span class="n">env变量定义格式</span>
<span class="n">VAR1</span><span class="o">=</span><span class="n">ABC</span>

<span class="p">{{</span><span class="n">$aadToken</span><span class="w"> </span><span class="p">[</span><span class="n">new</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">public</span><span class="o">|</span><span class="n">cn</span><span class="o">|</span><span class="n">de</span><span class="o">|</span><span class="n">us</span><span class="o">|</span><span class="n">ppe</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">&lt;</span><span class="n">domain</span><span class="o">|</span><span class="n">tenantId</span><span class="o">&gt;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">aud</span><span class="o">:&lt;</span><span class="n">domain</span><span class="o">|</span><span class="n">tenantId</span><span class="o">&gt;</span><span class="p">]}}</span>

<span class="p">{{</span><span class="n">$oidcAccessToken</span><span class="w">  </span><span class="p">[</span><span class="n">new</span><span class="p">]</span><span class="w">  </span><span class="p">[</span><span class="o">&lt;</span><span class="n">clientId</span><span class="o">:&lt;</span><span class="n">clientId</span><span class="o">&gt;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">&lt;</span><span class="n">callbackPort</span><span class="o">:&lt;</span><span class="n">callbackPort</span><span class="o">&gt;</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">authorizeEndpoint</span><span class="o">:&lt;</span><span class="n">authorizeEndpoint</span><span class="p">}]</span><span class="w"> </span><span class="p">[</span><span class="n">tokenEndpoint</span><span class="o">:&lt;</span><span class="n">tokenEndpoint</span><span class="p">}]</span><span class="w"> </span><span class="p">[</span><span class="n">scopes</span><span class="o">:&lt;</span><span class="n">scopes</span><span class="p">}]</span><span class="w"> </span><span class="p">[</span><span class="n">audience</span><span class="o">:&lt;</span><span class="n">audience</span><span class="p">}]}</span>
</code></pre></div>

<h2 id="_7">取消代理</h2>
<p>因为VSCode配置了代理, 而用rest-client时 基本上不要代理, 又没有关代理的配置
虽然rest-client提供了excludeHostsForProxy配置, 域名较多时 不够方便</p>
<p>可以修改以下文件:
c:\Users\Administrator.vscode\extensions\humao.rest-client-0.25.1\dist\extension.js</p>
<p>修改获取代理配置, 改名, 让找不到代理配置即可
workspace.getConfiguration("http") -&gt; workspace.getConfiguration("http1")</p>
<p>不过环境变量如果配置了http.proxy, 应该还能用, 未测试.</p>
<h2 id="_8">相关链接</h2>
<p><a href="https://github.com/Huachao/vscode-restclient">vscode-restclient</a></p>
  </article>
  
<script>
document.addEventListener('DOMContentLoaded', () => {
  // 复制功能
  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const code = btn.nextElementSibling.querySelector('code').innerText;
      navigator.clipboard.writeText(code).then(() => {
        btn.textContent = '已复制';
        setTimeout(() => btn.textContent = '复制', 1500);
      });
    });
  });

  // 折叠功能
  document.addEventListener('click', e => {
    if (e.target.classList.contains('fold-btn')) {
      const pre = e.target.parentElement.querySelector('pre');
      const collapsed = pre.style.display === 'none';
      pre.style.display = collapsed ? 'block' : 'none';
      e.target.textContent = collapsed ? '收起' : '展开';
    }
  });
});
</script>

