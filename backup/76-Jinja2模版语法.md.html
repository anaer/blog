<div class="markdown-heading"><h3 class="heading-element">Jinja2模版语法</h3><a id="user-content-jinja2模版语法" class="anchor" aria-label="Permalink: Jinja2模版语法" href="#jinja2模版语法"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<hr>
<div class="markdown-heading"><h4 class="heading-element">一、基础语法结构</h4><a id="user-content-一基础语法结构" class="anchor" aria-label="Permalink: 一、基础语法结构" href="#一基础语法结构"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ol>
<li>
<p><strong>变量输出</strong></p>
<div class="highlight highlight-text-html-django"><pre>{{ variable }}                <span class="pl-c">{# 基础输出 #}</span>
{{ variable|default("N/A") }} <span class="pl-c">{# 设置默认值 #}</span>
{{ user.name|title }}         <span class="pl-c">{# 过滤器链式操作 #}</span></pre></div>
</li>
<li>
<p><strong>逻辑控制</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">if</span> <span class="pl-s">score</span> &gt; 90 <span class="pl-e">%}</span>
  优秀
<span class="pl-e">{%</span> <span class="pl-s">elif</span> <span class="pl-s">score</span> &gt; 60 <span class="pl-e">%}</span>
  合格
<span class="pl-e">{%</span> <span class="pl-k">else</span> <span class="pl-e">%}</span>
  不合格
<span class="pl-e">{%</span> <span class="pl-k">endif</span> <span class="pl-e">%}</span></pre></div>
</li>
<li>
<p><strong>循环结构</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">for</span> <span class="pl-s">item</span> <span class="pl-k">in</span> <span class="pl-s">items</span> <span class="pl-e">%}</span>
  &lt;<span class="pl-ent">li</span>&gt;{{ loop.index }}. {{ item.name }}&lt;/<span class="pl-ent">li</span>&gt;
<span class="pl-e">{%</span> <span class="pl-k">else</span> <span class="pl-e">%}</span>
  &lt;<span class="pl-ent">p</span>&gt;暂无数据&lt;/<span class="pl-ent">p</span>&gt;
<span class="pl-e">{%</span> <span class="pl-k">endfor</span> <span class="pl-e">%}</span></pre></div>
</li>
</ol>
<hr>
<div class="markdown-heading"><h4 class="heading-element">二、模板继承系统</h4><a id="user-content-二模板继承系统" class="anchor" aria-label="Permalink: 二、模板继承系统" href="#二模板继承系统"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ol>
<li>
<p><strong>父模板定义</strong> (<code>base.html</code>)</p>
<div class="highlight highlight-text-html-django"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span>&gt;
&lt;<span class="pl-ent">head</span>&gt;
  <span class="pl-e">{%</span> <span class="pl-k">block</span> <span class="pl-s">head</span> <span class="pl-e">%}</span>
    &lt;<span class="pl-ent">title</span>&gt;<span class="pl-e">{%</span> <span class="pl-k">block</span> <span class="pl-s">title</span> <span class="pl-e">%}</span>默认标题<span class="pl-e">{%</span> <span class="pl-k">endblock</span> <span class="pl-e">%}</span>&lt;/<span class="pl-ent">title</span>&gt;
  <span class="pl-e">{%</span> <span class="pl-k">endblock</span> <span class="pl-e">%}</span>
&lt;/<span class="pl-ent">head</span>&gt;
&lt;<span class="pl-ent">body</span>&gt;
  <span class="pl-e">{%</span> <span class="pl-k">block</span> <span class="pl-s">content</span> <span class="pl-e">%}{%</span> <span class="pl-k">endblock</span> <span class="pl-e">%}</span>
&lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>
</li>
<li>
<p><strong>子模板扩展</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">extends</span> <span class="pl-s">"base.html"</span> <span class="pl-e">%}</span>

<span class="pl-e">{%</span> <span class="pl-k">block</span> <span class="pl-s">title</span> <span class="pl-e">%}</span>子页面标题<span class="pl-e">{%</span> <span class="pl-k">endblock</span> <span class="pl-e">%}</span>

<span class="pl-e">{%</span> <span class="pl-k">block</span> <span class="pl-s">content</span> <span class="pl-e">%}</span>
  &lt;<span class="pl-ent">h1</span>&gt;{{ self.title() }}&lt;/<span class="pl-ent">h1</span>&gt;
  <span class="pl-e">{%</span> <span class="pl-k">include</span> <span class="pl-s">"partials/nav.html"</span> <span class="pl-e">%}</span>
<span class="pl-e">{%</span> <span class="pl-k">endblock</span> <span class="pl-e">%}</span></pre></div>
</li>
</ol>
<hr>
<div class="markdown-heading"><h4 class="heading-element">三、高级功能组件</h4><a id="user-content-三高级功能组件" class="anchor" aria-label="Permalink: 三、高级功能组件" href="#三高级功能组件"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ol>
<li>
<p><strong>宏（Macros）</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-s">macro</span> <span class="pl-s">input</span>(<span class="pl-s">name</span>, <span class="pl-s">value</span>=<span class="pl-s">''</span>, <span class="pl-s">type</span>=<span class="pl-s">'text'</span>) <span class="pl-e">%}</span>
  &lt;<span class="pl-ent">input</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>{{ type }}<span class="pl-pds">"</span></span> 
         <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>{{ name }}<span class="pl-pds">"</span></span> 
         <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">"</span>{{ value|e }}<span class="pl-pds">"</span></span> 
         <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>form-control<span class="pl-pds">"</span></span>&gt;
<span class="pl-e">{%</span> <span class="pl-s">endmacro</span> <span class="pl-e">%}</span>

{{ input('username') }}               <span class="pl-c">{# 调用宏 #}</span>
{{ input('email', type='email') }}    <span class="pl-c">{# 带参数覆盖 #}</span></pre></div>
</li>
<li>
<p><strong>过滤器（Filters）</strong></p>
<div class="highlight highlight-text-html-django"><pre>{{ text|trim|upper }}                  <span class="pl-c">{# 内置过滤器 #}</span>
{{ list|join(', ') }}                  <span class="pl-c">{# 列表转字符串 #}</span>
{{ date|datetime(format='%Y-%m-%d') }} <span class="pl-c">{# 自定义过滤器 #}</span></pre></div>
</li>
<li>
<p><strong>测试器（Tests）</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">if</span> <span class="pl-s">variable</span> <span class="pl-s">is</span> <span class="pl-s">defined</span> <span class="pl-e">%}</span>      <span class="pl-c">{# 检查变量存在性 #}</span>
<span class="pl-e">{%</span> <span class="pl-k">if</span> <span class="pl-s">number</span> <span class="pl-s">is</span> <span class="pl-s">even</span> <span class="pl-e">%}</span>           <span class="pl-c">{# 数值类型测试 #}</span>
<span class="pl-e">{%</span> <span class="pl-k">if</span> <span class="pl-s">string</span> <span class="pl-s">is</span> <span class="pl-s">sequence</span> <span class="pl-e">%}</span>       <span class="pl-c">{# 可迭代对象检测 #}</span></pre></div>
</li>
</ol>
<hr>
<div class="markdown-heading"><h4 class="heading-element">四、安全控制机制</h4><a id="user-content-四安全控制机制" class="anchor" aria-label="Permalink: 四、安全控制机制" href="#四安全控制机制"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ol>
<li>
<p><strong>自动转义</strong></p>
<div class="highlight highlight-text-html-django"><pre>{{ user_input }}                <span class="pl-c">{# 自动HTML转义 #}</span>
{{ safe_html|safe }}            <span class="pl-c">{# 标记安全内容 #}</span>
<span class="pl-e">{%</span> <span class="pl-k">autoescape</span> <span class="pl-s">false</span> <span class="pl-e">%}</span>          <span class="pl-c">{# 关闭局部转义 #}</span>
  {{ raw_content }}
<span class="pl-e">{%</span> <span class="pl-k">endautoescape</span> <span class="pl-e">%}</span></pre></div>
</li>
<li>
<p><strong>沙箱模式限制</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-c">{# 在受限环境中禁止以下操作： #}</span>
<span class="pl-e">{%</span> <span class="pl-s">forbidden_tag</span> <span class="pl-e">%}</span>             <span class="pl-c">{# 禁用危险标签 #}</span>
{{ __import__('os') }}          <span class="pl-c">{# 禁止Python函数调用 #}</span></pre></div>
</li>
</ol>
<hr>
<div class="markdown-heading"><h4 class="heading-element">五、空白控制</h4><a id="user-content-五空白控制" class="anchor" aria-label="Permalink: 五、空白控制" href="#五空白控制"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">for</span> <span class="pl-s">item</span> <span class="pl-k">in</span> <span class="pl-s">list</span> -<span class="pl-e">%}</span>   <span class="pl-c">{# 移除行首空白 #}</span>
  {{ item }}
<span class="pl-e">{%</span>- <span class="pl-k">endfor</span> <span class="pl-e">%}</span>             <span class="pl-c">{# 移除行尾空白 #}</span>

<span class="pl-c">{# 输出结果无空行： #}</span>
<span class="pl-e">{%</span> <span class="pl-k">if</span> <span class="pl-s">true</span> <span class="pl-e">%}</span>...<span class="pl-e">{%</span> <span class="pl-k">endif</span> <span class="pl-e">%}</span></pre></div>
<hr>
<div class="markdown-heading"><h4 class="heading-element">六、注释语法</h4><a id="user-content-六注释语法" class="anchor" aria-label="Permalink: 六、注释语法" href="#六注释语法"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<div class="highlight highlight-text-html-django"><pre><span class="pl-c">{# 单行注释 #}</span>

<span class="pl-c">{#</span>
<span class="pl-c">  多行注释</span>
<span class="pl-c">  模板调试时使用</span>
<span class="pl-c">#}</span>

{{ "注释内容不会出现在输出中" }}</pre></div>
<hr>
<div class="markdown-heading"><h4 class="heading-element">七、包含与导入</h4><a id="user-content-七包含与导入" class="anchor" aria-label="Permalink: 七、包含与导入" href="#七包含与导入"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ol>
<li>
<p><strong>文件包含</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-k">include</span> <span class="pl-s">'header.html'</span> <span class="pl-s">ignore</span> <span class="pl-s">missing</span> <span class="pl-e">%}</span>  <span class="pl-c">{# 忽略缺失文件 #}</span></pre></div>
</li>
<li>
<p><strong>模块化组织</strong></p>
<div class="highlight highlight-text-html-django"><pre><span class="pl-e">{%</span> <span class="pl-s">from</span> <span class="pl-s">'forms.html'</span> <span class="pl-s">import</span> <span class="pl-s">input</span> <span class="pl-k">as</span> <span class="pl-s">field</span> <span class="pl-e">%}</span>  <span class="pl-c">{# 导入单个宏 #}</span>
<span class="pl-e">{%</span> <span class="pl-s">import</span> <span class="pl-s">'macros.html'</span> <span class="pl-k">as</span> <span class="pl-s">macros</span> <span class="pl-e">%}</span>           <span class="pl-c">{# 导入整个模块 #}</span></pre></div>
</li>
</ol>
<hr>
