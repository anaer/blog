<p>vim /etc/fail2ban/jail.d/nginx.conf</p>
<pre lang="conf"><code>[nginx-cc]
enabled = true
filter = nginx-cc
action = iptables-multiport[name=nginx-cc,port="80,443"]
         bark[name=nginx-cc]
maxretry = 120
findtime = 60s
bantime = 2d
logpath = /var/log/nginx/access.log

[nginx-404]
enabled = true
filter = nginx-404
action = iptables-multiport[name=nginx-404,port="80,443"]
         bark[name=nginx-404]
maxretry = 3
findtime = 60s
bantime = 1d
logpath = /var/log/nginx/access.log

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
action = iptables-multiport[name=nginx-http-auth,port="80,443"]
         bark[name=nginx-http-auth]
logpath = /var/log/nginx/access.log

</code></pre>
<p>vim /etc/fail2ban/filter.d/nginx-cc.conf</p>
<pre lang="conf"><code>[Definition]
failregex = &lt;HOST&gt; -.*- .*HTTP/1.* .* .*$
ignoreregex = .*(robots.txt|favicon.ico)
</code></pre>
<p>vim /etc/fail2ban/filter.d/nginx-404.conf</p>
<pre lang="conf"><code>[Definition]
failregex = &lt;HOST&gt; -.*- .*HTTP/1.* 404 .*$
ignoreregex = .*(robots.txt|favicon.ico)
</code></pre>
<p>nginx-http-auth 为自带规则</p>
<ol>
<li>#9</li>
</ol>
