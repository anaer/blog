å› ä¸ºåœ¨.git/configä¸­é‡‡ç”¨ includeIf æŒ‡ä»¤å®ç°æ™ºèƒ½åˆ‡æ¢ç”¨æˆ·ä¿¡æ¯äº†, ä¸éœ€è¦æ¯ä¸ªä»“åº“é…ç½®ç”¨æˆ·ä¿¡æ¯, æ‰€ä»¥æ¸…ä¸€ä¸‹ä»“åº“çš„ç”¨æˆ·ä¿¡æ¯

## æ£€æµ‹å¹¶å–æ¶ˆè®¾ç½® Git ä»“åº“ç”¨æˆ·ä¿¡æ¯

```python
import os
import argparse
import subprocess
import sys

def find_git_repos(root_dir):
    """
    é€’å½’æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ Git ä»“åº“
    """
    git_repos = []
    for dirpath, dirnames, filenames in os.walk(root_dir):
        if '.git' in dirnames:
            repo_path = os.path.abspath(dirpath)
            git_repos.append(repo_path)
            # è·³è¿‡å­ç›®å½•éå† (é¿å…å¤„ç†åµŒå¥—ä»“åº“)
            dirnames[:] = []
    return git_repos

def check_and_unset_config(repo_path):
    """
    æ£€æŸ¥å¹¶å–æ¶ˆè®¾ç½®ç”¨æˆ·é…ç½®
    è¿”å›æ ¼å¼: (æ˜¯å¦å­˜åœ¨name, æ˜¯å¦å­˜åœ¨email, æ˜¯å¦æ‰§è¡Œäº†ä¿®æ”¹)
    """
    try:
        # æ£€æµ‹ user.name
        name_check = subprocess.run(
            ['git', '-C', repo_path, 'config', '--local', '--get', 'user.name'],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True
        )
        has_name = name_check.returncode == 0

        # æ£€æµ‹ user.email
        email_check = subprocess.run(
            ['git', '-C', repo_path, 'config', '--local', '--get', 'user.email'],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True
        )
        has_email = email_check.returncode == 0

        modified = False

        # å–æ¶ˆè®¾ç½®é…ç½®
        if has_name:
            subprocess.run(
                ['git', '-C', repo_path, 'config', '--local', '--unset', 'user.name'],
                check=True,
                stdout=subprocess.DEVNULL,
                stderr=subprocess.DEVNULL
            )
            modified = True

        if has_email:
            subprocess.run(
                ['git', '-C', repo_path, 'config', '--local', '--unset', 'user.email'],
                check=True,
                stdout=subprocess.DEVNULL,
                stderr=subprocess.DEVNULL
            )
            modified = True

        return has_name, has_email, modified

    except subprocess.CalledProcessError as e:
        print(f"å¤„ç†ä»“åº“æ—¶å‡ºé”™ {repo_path}: {str(e)}")
        return False, False, False

def main():
    parser = argparse.ArgumentParser(description='Git ç”¨æˆ·ä¿¡æ¯æ¸…ç†å·¥å…·')
    parser.add_argument(
        'directory',
        type=str,
        help='è¦æ‰«æçš„æ ¹ç›®å½•è·¯å¾„',
        nargs='?',
        default=os.getcwd()
    )
    args = parser.parse_args()

    root_dir = os.path.abspath(args.directory)
    if not os.path.isdir(root_dir):
        print(f"é”™è¯¯: è·¯å¾„ä¸å­˜åœ¨æˆ–ä¸æ˜¯ç›®å½• [{root_dir}]")
        sys.exit(1)

    repositories = find_git_repos(root_dir)
    print(f"å…±å‘ç° {len(repositories)} ä¸ª Git ä»“åº“")

    for repo in repositories:
        print(f"\nğŸ” æ­£åœ¨æ£€æŸ¥ä»“åº“ï¼š{repo}")
        has_name, has_email, modified = check_and_unset_config(repo)

        status = []
        if has_name: status.append("å­˜åœ¨ user.name")
        if has_email: status.append("å­˜åœ¨ user.email")
      
        if status:
            print("   â†’ å‘ç°é…ç½®: " + ", ".join(status))
            if modified:
                print("   âœ… å·²æ¸…ç†æœ¬åœ°é…ç½®")
        else:
            print("   âœ… æœªé…ç½®æœ¬åœ°ç”¨æˆ·ä¿¡æ¯")

if __name__ == "__main__":
    main()
```

### ä½¿ç”¨æ–¹å¼

```bash
# æ‰«æå½“å‰ç›®å½•
python git_cleaner.py

# æ‰«ææŒ‡å®šç›®å½•
python git_cleaner.py /path/to/projects
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
å…±å‘ç° 3 ä¸ª Git ä»“åº“

ğŸ” æ­£åœ¨æ£€æŸ¥ä»“åº“ï¼š/home/user/projects/repo1
   â†’ å‘ç°é…ç½®: å­˜åœ¨ user.name, å­˜åœ¨ user.email
   âœ… å·²æ¸…ç†æœ¬åœ°é…ç½®

ğŸ” æ­£åœ¨æ£€æŸ¥ä»“åº“ï¼š/home/user/projects/repo2
   âœ… æœªé…ç½®æœ¬åœ°ç”¨æˆ·ä¿¡æ¯

ğŸ” æ­£åœ¨æ£€æŸ¥ä»“åº“ï¼š/home/user/projects/repo3
   â†’ å‘ç°é…ç½®: å­˜åœ¨ user.email
   âœ… å·²æ¸…ç†æœ¬åœ°é…ç½®
```