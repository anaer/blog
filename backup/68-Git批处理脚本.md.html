
  <article class="markdown-body">
    <h2 id="_1">循环执行脚本</h2>
<p>判断参数命令执行结果, 如果失败则重复执行<br />
<code>retry.cmd git push origin main</code>  </p>
<div class="highlight"><div><button class="fold-btn">收起</button><button class="copy-btn">复制</button>
<pre><span></span><code>@echo<span class="w"> </span>off<span class="w">  </span>
chcp<span class="w"> </span><span class="m">65001</span><span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>%*<span class="w">  </span>
<span class="k">for</span><span class="w"> </span>/l<span class="w"> </span>%%a<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">(</span><span class="m">1</span>,1,100<span class="o">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">(</span><span class="nb">echo</span><span class="w"> </span>%%a-------------------<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%*<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>goto<span class="w"> </span>:EOF<span class="p">;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="o">)</span><span class="w">  </span>

:EOF<span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>-------------------end<span class="w">  </span>
</code></pre></div></div>
<h2 id="git">git推拉脚本</h2>
<p>因github容易连不上, 所以pull, push时, 有时需要循环执行<br />
暂定间隔5秒循环执行, 一般10次以内能成功 这里设置了100次, 如果需要永久循环 设置为(0,0,1)  </p>
<p>用法: 将pull.cmd, push.cmd脚本放到PATH目录下, 使用时直接在仓库目录, 执行pull, push即可  </p>
<h3 id="pullcmd">pull.cmd</h3>
<div class="highlight"><div><button class="fold-btn">收起</button><button class="copy-btn">复制</button>
<pre><span></span><code>@echo<span class="w"> </span>off<span class="w">  </span>
chcp<span class="w"> </span><span class="m">65001</span><span class="w">  </span>
rem<span class="w"> </span>因github容易连不上,<span class="w"> </span>所以间隔5秒循环执行,<span class="w"> </span>一般10次以内都能成功<span class="w"> </span>这里设置了100次,<span class="w"> </span>如果需要永久循环<span class="w"> </span>设置为<span class="o">(</span><span class="m">0</span>,0,1<span class="o">)</span><span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>git<span class="w"> </span>pull<span class="w">  </span>
git<span class="w"> </span>rev-parse<span class="w"> </span>--is-inside-work-tree<span class="w"> </span>&gt;nul<span class="w"> </span><span class="m">2</span>&gt;nul<span class="w">  </span>
<span class="k">if</span><span class="w"> </span>%errorlevel%<span class="w"> </span>equ<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="w">  </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>/l<span class="w"> </span>%%a<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">(</span><span class="m">1</span>,1,100<span class="o">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">(</span><span class="nb">echo</span><span class="w"> </span>%%a-----------------------<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>pull<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>goto<span class="w"> </span>:EOF<span class="p">;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="o">)</span><span class="w">  </span>
<span class="o">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">(</span><span class="w">  </span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>当前目录不是git仓库<span class="w">  </span>
<span class="o">)</span><span class="w">  </span>
:EOF<span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>-------------------------end<span class="w">  </span>
</code></pre></div></div>
<h3 id="pushcmd">push.cmd</h3>
<div class="highlight"><div><button class="fold-btn">收起</button><button class="copy-btn">复制</button>
<pre><span></span><code>@echo<span class="w"> </span>off<span class="w">  </span>
chcp<span class="w"> </span><span class="m">65001</span><span class="w">  </span>
rem<span class="w"> </span>因github容易连不上,<span class="w"> </span>所以间隔5秒循环执行,<span class="w"> </span>一般10次以内都能成功<span class="w"> </span>这里设置了100次,<span class="w"> </span>如果需要永久循环<span class="w"> </span>设置为<span class="o">(</span><span class="m">0</span>,0,1<span class="o">)</span><span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>git<span class="w"> </span>push<span class="w">  </span>
git<span class="w"> </span>rev-parse<span class="w"> </span>--is-inside-work-tree<span class="w"> </span>&gt;nul<span class="w"> </span><span class="m">2</span>&gt;nul<span class="w">  </span>
<span class="k">if</span><span class="w"> </span>%errorlevel%<span class="w"> </span>equ<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="w">  </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>/l<span class="w"> </span>%%a<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">(</span><span class="m">1</span>,1,100<span class="o">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">(</span><span class="nb">echo</span><span class="w"> </span>%%a-------------------<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>goto<span class="w"> </span>:EOF<span class="p">;</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="o">)</span><span class="w">  </span>
<span class="o">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">(</span><span class="w">  </span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span>当前目录不是git仓库<span class="w">  </span>
<span class="o">)</span><span class="w">  </span>

:EOF<span class="w">  </span>
<span class="nb">echo</span><span class="w"> </span>-------------------end<span class="w">  </span>
</code></pre></div></div>
<h2 id="macalias">Mac添加alias实现</h2>
<div class="highlight"><div><button class="fold-btn">收起</button><button class="copy-btn">复制</button>
<pre><span></span><code>pull=&#39;for i in `seq 1 100`; do echo $i &amp;&amp; git pull &amp;&amp; break; sleep 5; done&#39;  
push=&#39;for i in `seq 1 100`; do echo $i &amp;&amp; git push &amp;&amp; break; done&#39;  
</code></pre></div></div>
<h2 id="chcp">chcp</h2>
<p>修改cmd编码  </p>
<div class="highlight"><div><button class="fold-btn">收起</button><button class="copy-btn">复制</button>
<pre><span></span><code>chcp<span class="w"> </span><span class="m">936</span><span class="w">  </span><span class="c1">#GBK  </span>
chcp<span class="w"> </span><span class="m">65001</span><span class="w"> </span><span class="c1">#UTF-8  </span>
</code></pre></div></div>
  </article>
  
<script>
document.addEventListener('DOMContentLoaded', () => {
  // 复制功能
  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const code = btn.nextElementSibling.querySelector('code').innerText;
      navigator.clipboard.writeText(code).then(() => {
        btn.textContent = '已复制';
        setTimeout(() => btn.textContent = '复制', 1500);
      });
    });
  });

  // 折叠功能
  document.addEventListener('click', e => {
    if (e.target.classList.contains('fold-btn')) {
      const pre = e.target.parentElement.querySelector('pre');
      const collapsed = pre.style.display === 'none';
      pre.style.display = collapsed ? 'block' : 'none';
      e.target.textContent = collapsed ? '收起' : '展开';
    }
  });
});
</script>

