<div class="markdown-heading"><h2 class="heading-element">统计耗时</h2><a id="user-content-统计耗时" class="anchor" aria-label="Permalink: 统计耗时" href="#统计耗时"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>通过curl命令来查询https请求各阶段的耗时</p>
<div class="markdown-heading"><h3 class="heading-element">时间统计</h3><a id="user-content-时间统计" class="anchor" aria-label="Permalink: 时间统计" href="#时间统计"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<table>
<thead>
<tr>
<th>阶段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>time_namelookup</td>
<td>从请求开始到DNS解析完成的耗时</td>
</tr>
<tr>
<td>time_connect</td>
<td>从请求开始到TCP三次握手完成耗时</td>
</tr>
<tr>
<td>time_appconnect</td>
<td>从请求开始到TLS握手完成的耗时</td>
</tr>
<tr>
<td>time_pretransfer</td>
<td>从请求开始到向服务器发送第一个GET/POST请求开始之前的耗时</td>
</tr>
<tr>
<td>time_redirect</td>
<td>重定向时间，包括到内容传输前的重定向的DNS解析、TCP连接、内容传输等时间</td>
</tr>
<tr>
<td>time_starttransfer</td>
<td>从请求开始到内容传输前的时间</td>
</tr>
<tr>
<td>time_total</td>
<td>从请求开始到完成的总耗时</td>
</tr>
</tbody>
</table>
<div class="markdown-heading"><h3 class="heading-element">HTTP性能指标</h3><a id="user-content-http性能指标" class="anchor" aria-label="Permalink: HTTP性能指标" href="#http性能指标"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<table>
<thead>
<tr>
<th>指标</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DNS请求耗时</td>
<td>域名的NS及本地使用DNS的解析速度</td>
</tr>
<tr>
<td>TCP建立耗时</td>
<td>服务器网络层面的速度</td>
</tr>
<tr>
<td>SSL握手耗时</td>
<td>服务器处理HTTPS等协议的速度</td>
</tr>
<tr>
<td>服务器处理请求时间</td>
<td>服务器处理HTTP请求的速度</td>
</tr>
<tr>
<td>TTFB</td>
<td>服务器从接收请求到开始到收到第一个字节的耗时</td>
</tr>
<tr>
<td>服务器响应耗时</td>
<td>服务器响应第一个字节到全部传输完成耗时</td>
</tr>
<tr>
<td>请求完成总耗时</td>
<td>服务器从请求开始到完成的总耗时</td>
</tr>
</tbody>
</table>
<p>DNS请求耗时 = time_namelookup</p>
<p>TCP三次握手耗时 = time_connect - time_namelookup</p>
<p>SSL握手耗时 = time_appconnect - time_connect</p>
<p>服务器处理请求耗时 = time_starttransfer - time_pretransfer</p>
<p>TTFB耗时 = time_starttransfer - time_appconnect</p>
<p>服务器传输耗时 = time_total - time_starttransfer</p>
<p>总耗时 = time_total</p>
<p>curl命令：</p>
<div class="highlight highlight-source-shell"><pre>curl -w <span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">   time_namelookup: %{time_namelookup}</span>
<span class="pl-s">      time_connect: %{time_connect}</span>
<span class="pl-s">   time_appconnect: %{time_appconnect}</span>
<span class="pl-s">     time_redirect: %{time_redirect}</span>
<span class="pl-s">  time_pretransfer: %{time_pretransfer}</span>
<span class="pl-s">time_starttransfer: %{time_starttransfer}</span>
<span class="pl-s">        ------------------------</span>
<span class="pl-s">        time_total: %{time_total}</span>
<span class="pl-s"><span class="pl-pds">'</span></span> -o /dev/null -s -L <span class="pl-s"><span class="pl-pds">'</span>https://www.baidu.com/<span class="pl-pds">'</span></span></pre></div>
<p>output:</p>
<pre><code>   time_namelookup: 0.001091
      time_connect: 0.011882
   time_appconnect: 0.223441
     time_redirect: 0.000000
  time_pretransfer: 0.223486
time_starttransfer: 0.235369
        ------------------------
        time_total: 0.235515
</code></pre>
