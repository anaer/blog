{% extends 'base.html' %}

{% block head %}
<title>{{ blogBase['postTitle'] }}</title>
{% if blogBase['highlight']==1 %}<link href="{{ blogBase['homeUrl'] }}/assets/starry-night@3.6.0/style/{{ blogBase['starryNight'] }}.css" rel="stylesheet" />{% endif %}
{% endblock %}

{% block style %}
<style>
h1 a:not([href]){color:inherit;text-decoration:none;vertical-align: bottom;font-size:35px;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 767px) {body {padding: 8px;}}
</style>
{{ blogBase['style'] }}

{% endblock %}
{% block header %}
<h1>
    <a>{{ blogBase['postTitle'] }}</a>
</h1>

<div class="title-right">

    <a href="{{ blogBase['homeUrl'] }}"><button id="buttonHome" class="btn btn-invisible circle" title="{{ i18n['home'] }}">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd" d="{{ IconList['home'] }}"></path>
        </svg>
    </button></a>

    <a href="{{ blogBase['postSourceUrl'] }}" target="_blank"><button class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd" d="{{ IconList['github'] }}"></path>
        </svg>
    </button></a>

    <button class="btn btn-invisible circle" onclick="modeSwitch();" title="{{ i18n['switchTheme'] }}">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </button>

</div>
{% endblock %}

{% block content %}

<div class="listLabels">
    {% for label in blogBase['labels'] -%}
        <span class="Label" style="max-width: 100px; height: 24px; border-radius: 4px; padding: 4px 8px; margin-right: 8px; display: inline-flex; align-items: center; justify-content: center; background-color:{{ blogBase['labelColorDict'][label] }}">
            <object><a style="color:#fff; text-decoration: none; font-size: 14px;" href="{{ blogBase['homeUrl'] }}/tag.html#{{ label }}">{{ label }}</a></object>
        </span>
    {%- endfor %}
</div>
<br>

<div id="vercount_container_page_pv" style="display:none;float:left;margin-top:0px;margin-right:5px;font-size:medium;">üëÅ<span id="vercount_value_page_pv"></span></div>
<span class="post-publish" id="postPublish" style="font-size: 14px; color: #666;">ÂèëÂ∏É‰∫é <time style="font-weight: bold; color: #333;">{{ blogBase['createdAt'] }}</time></span>
{% if blogBase['createdAt'] != blogBase['updatedAt'] %}
<span class="post-update" style="font-size: 14px; color: #666;">Êõ¥Êñ∞‰∫é <time style="font-weight: bold; color: #333;">{{ blogBase['updatedAt'] }}</time></span>
{% endif %}
<p>

<div class="markdown-body" id="postBody">
{{ blogBase['postBody'] }}
</div>

{%- if blogBase['prevUrl'] or blogBase['nextUrl'] -%}
<nav class="paginate-container" aria-label="Pagination">
    <div class="pagination">
        {%- if blogBase['prevTitle'] -%}
        <a class="previous_page" rel="previous" href="{{ blogBase['prevUrl'] }}" aria-label="Previous Page">{{ blogBase['prevTitle'] }}</a>
        {%- endif -%}
        <span style="width:200px" aria-disabled="true"></span>
        {%- if blogBase['nextTitle'] -%}
        <a class="next_page" rel="next" href="{{ blogBase['nextUrl'] }}" aria-label="Next Page">{{ blogBase['nextTitle'] }}</a>
        {%- endif -%}
    </div>
</nav>
{%- endif %}

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">{{ i18n['comments'] }}</button>
<div class="comments" id="comments"></div>
{% endblock %}

{% block script %}
<script>

{% if blogBase['commentNum']>0 -%}
    cmButton=document.getElementById("cmButton");
    span=document.createElement("span");
    span.setAttribute("class","Counter");
    span.innerHTML="{{ blogBase['commentNum'] }}";
    cmButton.appendChild(span);

    // Â¶ÇÊûúÂ≠òÂú®ËØÑËÆ∫ Âª∂Ëøü1ÁßíÂêéËá™Âä®Âä†ËΩΩ
    window.onload = function() {
    setTimeout(function() {
        openComments();
    }, 1000);
    };
{%- endif %}

function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","{{ blogBase['repoName'] }}");
    script.setAttribute("issue-term","title");
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else{script.setAttribute("theme","github-light");}
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

</script>

{{ blogBase['script'] }}

<script src="{{ blogBase['homeUrl'] }}/assets/toc.js"></script>

{% endblock %}
